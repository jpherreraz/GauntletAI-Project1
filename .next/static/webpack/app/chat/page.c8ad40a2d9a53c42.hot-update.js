"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/chat/page",{

/***/ "(app-pages-browser)/./src/services/messageService.ts":
/*!****************************************!*\
  !*** ./src/services/messageService.ts ***!
  \****************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETED_USER_ID: () => (/* binding */ DELETED_USER_ID),\n/* harmony export */   messageService: () => (/* binding */ messageService)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/DynamoDBClient.js\");\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/commands/PutItemCommand.js\");\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/commands/QueryCommand.js\");\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/commands/ScanCommand.js\");\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/commands/UpdateItemCommand.js\");\n/* harmony import */ var _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @aws-sdk/client-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/client-dynamodb/dist-es/commands/DeleteItemCommand.js\");\n/* harmony import */ var _aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/util-dynamodb */ \"(app-pages-browser)/./node_modules/@aws-sdk/util-dynamodb/dist-es/index.js\");\n\n\nconst dynamoClient = new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_1__.DynamoDBClient({\n    region: 'us-east-2',\n    credentials: {\n        accessKeyId: 'AKIAW5BDQ6ZZ3EIKJYUI',\n        secretAccessKey: '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'\n    }\n});\nconst DELETED_USER_ID = 'deleted_user';\nconst messageService = {\n    async sendMessage (message) {\n        const timestamp = Date.now();\n        const id = \"\".concat(timestamp, \"-\").concat(Math.random().toString(36).substr(2, 9));\n        const params = {\n            TableName: 'Messages',\n            Item: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                id,\n                channelId: message.channelId,\n                userId: message.userId,\n                text: message.text,\n                timestamp,\n                username: message.username,\n                replyToId: message.replyToId || null,\n                reactions: {}\n            })\n        };\n        try {\n            await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_2__.PutItemCommand(params));\n            console.log('Message sent to DynamoDB:', {\n                id,\n                timestamp\n            });\n            return {\n                id,\n                timestamp\n            };\n        } catch (error) {\n            console.error('Error sending message to DynamoDB:', error);\n            throw error;\n        }\n    },\n    async getMessages (channelId) {\n        const params = {\n            TableName: 'Messages',\n            KeyConditionExpression: 'channelId = :channelId',\n            ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                ':channelId': channelId\n            }),\n            ScanIndexForward: true // ascending order\n        };\n        try {\n            const { Items = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_3__.QueryCommand(params));\n            const messages = Items.map((item)=>{\n                const unmarshalled = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(item);\n                // Ensure reactions is always an object\n                if (!unmarshalled.reactions) {\n                    unmarshalled.reactions = {};\n                }\n                // Ensure replyToId is properly handled\n                if (unmarshalled.replyToId === null) {\n                    delete unmarshalled.replyToId;\n                }\n                return unmarshalled;\n            });\n            console.log('Retrieved messages:', messages.length);\n            return messages;\n        } catch (error) {\n            console.error('Error getting messages from DynamoDB:', error);\n            throw error;\n        }\n    },\n    async toggleReaction (param) {\n        let { messageId, emoji, userId, username } = param;\n        try {\n            console.log('Toggling reaction:', {\n                messageId,\n                emoji,\n                userId\n            });\n            const scanParams = {\n                TableName: 'Messages',\n                FilterExpression: 'id = :messageId',\n                ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                    ':messageId': messageId\n                })\n            };\n            const { Items = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__.ScanCommand(scanParams));\n            if (!Items.length) throw new Error('Message not found');\n            const message = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(Items[0]);\n            const reactions = message.reactions || {};\n            const users = reactions[emoji] || [];\n            const hasReacted = users.includes(userId);\n            const updateParams = {\n                TableName: 'Messages',\n                Key: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                    channelId: message.channelId,\n                    timestamp: message.timestamp\n                })\n            };\n            if (!message.reactions) {\n                updateParams.UpdateExpression = 'SET reactions = :reactions';\n                updateParams.ExpressionAttributeValues = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                    ':reactions': {\n                        [emoji]: [\n                            userId\n                        ]\n                    }\n                });\n            } else if (hasReacted) {\n                if (users.length === 1) {\n                    updateParams.UpdateExpression = 'REMOVE reactions.#e';\n                    updateParams.ExpressionAttributeNames = {\n                        '#e': emoji\n                    };\n                } else {\n                    updateParams.UpdateExpression = 'SET reactions.#e = :users';\n                    updateParams.ExpressionAttributeNames = {\n                        '#e': emoji\n                    };\n                    updateParams.ExpressionAttributeValues = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                        ':users': users.filter((id)=>id !== userId)\n                    });\n                }\n            } else {\n                updateParams.UpdateExpression = 'SET reactions.#e = :users';\n                updateParams.ExpressionAttributeNames = {\n                    '#e': emoji\n                };\n                updateParams.ExpressionAttributeValues = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                    ':users': [\n                        ...users,\n                        userId\n                    ]\n                });\n            }\n            await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_5__.UpdateItemCommand(updateParams));\n            return true;\n        } catch (error) {\n            console.error('Error toggling reaction:', error);\n            throw error;\n        }\n    },\n    async getMessage (messageId) {\n        const params = {\n            TableName: 'Messages',\n            FilterExpression: 'id = :messageId',\n            ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                ':messageId': messageId\n            })\n        };\n        const { Items = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__.ScanCommand(params));\n        if (!Items.length) return null;\n        const message = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(Items[0]);\n        return message;\n    },\n    async clearMessages () {\n        try {\n            const params = {\n                TableName: 'Messages'\n            };\n            const { Items = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__.ScanCommand(params));\n            for (const item of Items){\n                const deleteParams = {\n                    TableName: 'Messages',\n                    Key: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                        channelId: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(item).channelId,\n                        timestamp: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(item).timestamp\n                    })\n                };\n                await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_6__.DeleteItemCommand(deleteParams));\n            }\n            console.log('Cleared all messages');\n            return true;\n        } catch (error) {\n            console.error('Error clearing messages:', error);\n            throw error;\n        }\n    },\n    async reassignMessagesToDeletedUser (userId) {\n        try {\n            // Get all messages from this user\n            const params = {\n                TableName: 'Messages',\n                FilterExpression: 'userId = :userId',\n                ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                    ':userId': userId\n                })\n            };\n            const { Items = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__.ScanCommand(params));\n            // Get message IDs for filtering replies later\n            const messageIds = Items.map((item)=>(0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(item).id);\n            // Update each message to use the deleted user ID\n            for (const item of Items){\n                const message = (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.unmarshall)(item);\n                const updateParams = {\n                    TableName: 'Messages',\n                    Key: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                        channelId: message.channelId,\n                        timestamp: message.timestamp\n                    }),\n                    UpdateExpression: 'SET userId = :deletedId, username = :deletedName',\n                    ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                        ':deletedId': DELETED_USER_ID,\n                        ':deletedName': 'Deleted User'\n                    }),\n                    ReturnValues: 'ALL_NEW'\n                };\n                await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_5__.UpdateItemCommand(updateParams));\n            }\n            // Find replies using multiple scans if needed\n            for (const messageId of messageIds){\n                const replyParams = {\n                    TableName: 'Messages',\n                    FilterExpression: 'replyToId = :messageId',\n                    ExpressionAttributeValues: (0,_aws_sdk_util_dynamodb__WEBPACK_IMPORTED_MODULE_0__.marshall)({\n                        ':messageId': messageId\n                    })\n                };\n                const { Items: ReplyItems = [] } = await dynamoClient.send(new _aws_sdk_client_dynamodb__WEBPACK_IMPORTED_MODULE_4__.ScanCommand(replyParams));\n                // No need to update replies, just keeping them for reference\n                console.log(\"Found \".concat(ReplyItems.length, \" replies to message \").concat(messageId));\n            }\n            return true;\n        } catch (error) {\n            console.error('Error reassigning messages:', error);\n            return false;\n        }\n    }\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9tZXNzYWdlU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBMko7QUFDN0Y7QUFFOUQsTUFBTVEsZUFBZSxJQUFJUixvRUFBY0EsQ0FBQztJQUN0Q1MsUUFBUTtJQUNSQyxhQUFhO1FBQ1hDLGFBQWE7UUFDYkMsaUJBQWlCO0lBQ25CO0FBQ0Y7QUFFTyxNQUFNQyxrQkFBa0IsZUFBZTtBQTRCdkMsTUFBTUMsaUJBQWlDO0lBQzVDLE1BQU1DLGFBQVlDLE9BQTBDO1FBQzFELE1BQU1DLFlBQVlDLEtBQUtDLEdBQUc7UUFDMUIsTUFBTUMsS0FBSyxHQUFnQkMsT0FBYkosV0FBVSxLQUEyQyxPQUF4Q0ksS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsTUFBTSxDQUFDLEdBQUc7UUFFaEUsTUFBTUMsU0FBUztZQUNiQyxXQUFXO1lBQ1hDLE1BQU1yQixnRUFBUUEsQ0FBQztnQkFDYmM7Z0JBQ0FRLFdBQVdaLFFBQVFZLFNBQVM7Z0JBQzVCQyxRQUFRYixRQUFRYSxNQUFNO2dCQUN0QkMsTUFBTWQsUUFBUWMsSUFBSTtnQkFDbEJiO2dCQUNBYyxVQUFVZixRQUFRZSxRQUFRO2dCQUMxQkMsV0FBV2hCLFFBQVFnQixTQUFTLElBQUk7Z0JBQ2hDQyxXQUFXLENBQUM7WUFDZDtRQUNGO1FBRUEsSUFBSTtZQUNGLE1BQU16QixhQUFhMEIsSUFBSSxDQUFDLElBQUlqQyxvRUFBY0EsQ0FBQ3dCO1lBQzNDVSxRQUFRQyxHQUFHLENBQUMsNkJBQTZCO2dCQUFFaEI7Z0JBQUlIO1lBQVU7WUFDekQsT0FBTztnQkFBRUc7Z0JBQUlIO1lBQVU7UUFDekIsRUFBRSxPQUFPb0IsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsc0NBQXNDQTtZQUNwRCxNQUFNQTtRQUNSO0lBQ0Y7SUFFQSxNQUFNQyxhQUFZVixTQUFpQjtRQUNqQyxNQUFNSCxTQUFTO1lBQ2JDLFdBQVc7WUFDWGEsd0JBQXdC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Z0JBQ0Y7Z0JBRUEsTUFBTSxFQUFFUCxPQUFPMkIsYUFBYSxFQUFFLEVBQUUsR0FBRyxNQUFNN0QsYUFBYTBCLElBQUksQ0FBQyxJQUFJOUIsaUVBQVdBLENBQUNnRTtnQkFFM0UsNkRBQTZEO2dCQUM3RGpDLFFBQVFDLEdBQUcsQ0FBQyxTQUFpRGEsT0FBeENvQixXQUFXdEIsTUFBTSxFQUFDLHdCQUFnQyxPQUFWRTtZQUMvRDtZQUVBLE9BQU87UUFDVCxFQUFFLE9BQU9aLE9BQU87WUFDZEYsUUFBUUUsS0FBSyxDQUFDLCtCQUErQkE7WUFDN0MsT0FBTztRQUNUO0lBQ0Y7QUFDRixFQUFFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGp1YW5wXFxHYXVudGxldEFJXFxQcm9qZWN0IDFcXHNyY1xcc2VydmljZXNcXG1lc3NhZ2VTZXJ2aWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IER5bmFtb0RCQ2xpZW50LCBQdXRJdGVtQ29tbWFuZCwgUXVlcnlDb21tYW5kLCBHZXRJdGVtQ29tbWFuZCwgVXBkYXRlSXRlbUNvbW1hbmQsIFNjYW5Db21tYW5kLCBEZWxldGVJdGVtQ29tbWFuZCB9IGZyb20gXCJAYXdzLXNkay9jbGllbnQtZHluYW1vZGJcIjtcbmltcG9ydCB7IG1hcnNoYWxsLCB1bm1hcnNoYWxsIH0gZnJvbSBcIkBhd3Mtc2RrL3V0aWwtZHluYW1vZGJcIjtcblxuY29uc3QgZHluYW1vQ2xpZW50ID0gbmV3IER5bmFtb0RCQ2xpZW50KHtcbiAgcmVnaW9uOiAndXMtZWFzdC0yJyxcbiAgY3JlZGVudGlhbHM6IHtcbiAgICBhY2Nlc3NLZXlJZDogJ0FLSUFXNUJEUTZaWjNFSUtKWVVJJyxcbiAgICBzZWNyZXRBY2Nlc3NLZXk6ICdjMmJPR2tMRTllelh2dEt4Sm13eGp4R3FiWHpPRHFyckNjaFk1OTU0J1xuICB9XG59KTtcblxuZXhwb3J0IGNvbnN0IERFTEVURURfVVNFUl9JRCA9ICdkZWxldGVkX3VzZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1lc3NhZ2Uge1xuICBpZDogc3RyaW5nO1xuICBjaGFubmVsSWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIHVzZXJuYW1lOiBzdHJpbmc7XG4gIHJlcGx5VG9JZD86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFJlYWN0aW9uRGF0YSB7XG4gIG1lc3NhZ2VJZDogc3RyaW5nO1xuICBlbW9qaTogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgdXNlcm5hbWU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIE1lc3NhZ2VTZXJ2aWNlIHtcbiAgc2VuZE1lc3NhZ2UobWVzc2FnZTogT21pdDxNZXNzYWdlLCAnaWQnIHwgJ3RpbWVzdGFtcCc+KTogUHJvbWlzZTx7IGlkOiBzdHJpbmc7IHRpbWVzdGFtcDogbnVtYmVyIH0+O1xuICBnZXRNZXNzYWdlcyhjaGFubmVsSWQ6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZVtdPjtcbiAgdG9nZ2xlUmVhY3Rpb24oZGF0YTogUmVhY3Rpb25EYXRhKTogUHJvbWlzZTxib29sZWFuPjtcbiAgZ2V0TWVzc2FnZShtZXNzYWdlSWQ6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZSB8IG51bGw+O1xuICBjbGVhck1lc3NhZ2VzKCk6IFByb21pc2U8Ym9vbGVhbj47XG4gIHJlYXNzaWduTWVzc2FnZXNUb0RlbGV0ZWRVc2VyKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPjtcbn1cblxuZXhwb3J0IGNvbnN0IG1lc3NhZ2VTZXJ2aWNlOiBNZXNzYWdlU2VydmljZSA9IHtcbiAgYXN5bmMgc2VuZE1lc3NhZ2UobWVzc2FnZTogT21pdDxNZXNzYWdlLCAnaWQnIHwgJ3RpbWVzdGFtcCc+KSB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgICBjb25zdCBpZCA9IGAke3RpbWVzdGFtcH0tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcblxuICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgIEl0ZW06IG1hcnNoYWxsKHtcbiAgICAgICAgaWQsXG4gICAgICAgIGNoYW5uZWxJZDogbWVzc2FnZS5jaGFubmVsSWQsXG4gICAgICAgIHVzZXJJZDogbWVzc2FnZS51c2VySWQsXG4gICAgICAgIHRleHQ6IG1lc3NhZ2UudGV4dCxcbiAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICB1c2VybmFtZTogbWVzc2FnZS51c2VybmFtZSxcbiAgICAgICAgcmVwbHlUb0lkOiBtZXNzYWdlLnJlcGx5VG9JZCB8fCBudWxsLFxuICAgICAgICByZWFjdGlvbnM6IHt9XG4gICAgICB9KVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgYXdhaXQgZHluYW1vQ2xpZW50LnNlbmQobmV3IFB1dEl0ZW1Db21tYW5kKHBhcmFtcykpO1xuICAgICAgY29uc29sZS5sb2coJ01lc3NhZ2Ugc2VudCB0byBEeW5hbW9EQjonLCB7IGlkLCB0aW1lc3RhbXAgfSk7XG4gICAgICByZXR1cm4geyBpZCwgdGltZXN0YW1wIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgbWVzc2FnZSB0byBEeW5hbW9EQjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgZ2V0TWVzc2FnZXMoY2hhbm5lbElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICBUYWJsZU5hbWU6ICdNZXNzYWdlcycsXG4gICAgICBLZXlDb25kaXRpb25FeHByZXNzaW9uOiAnY2hhbm5lbElkID0gOmNoYW5uZWxJZCcsXG4gICAgICBFeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzOiBtYXJzaGFsbCh7XG4gICAgICAgICc6Y2hhbm5lbElkJzogY2hhbm5lbElkXG4gICAgICB9KSxcbiAgICAgIFNjYW5JbmRleEZvcndhcmQ6IHRydWUgLy8gYXNjZW5kaW5nIG9yZGVyXG4gICAgfTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IEl0ZW1zID0gW10gfSA9IGF3YWl0IGR5bmFtb0NsaWVudC5zZW5kKG5ldyBRdWVyeUNvbW1hbmQocGFyYW1zKSk7XG4gICAgICBjb25zdCBtZXNzYWdlcyA9IEl0ZW1zLm1hcChpdGVtID0+IHtcbiAgICAgICAgY29uc3QgdW5tYXJzaGFsbGVkID0gdW5tYXJzaGFsbChpdGVtKTtcbiAgICAgICAgLy8gRW5zdXJlIHJlYWN0aW9ucyBpcyBhbHdheXMgYW4gb2JqZWN0XG4gICAgICAgIGlmICghdW5tYXJzaGFsbGVkLnJlYWN0aW9ucykge1xuICAgICAgICAgIHVubWFyc2hhbGxlZC5yZWFjdGlvbnMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICAvLyBFbnN1cmUgcmVwbHlUb0lkIGlzIHByb3Blcmx5IGhhbmRsZWRcbiAgICAgICAgaWYgKHVubWFyc2hhbGxlZC5yZXBseVRvSWQgPT09IG51bGwpIHtcbiAgICAgICAgICBkZWxldGUgdW5tYXJzaGFsbGVkLnJlcGx5VG9JZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5tYXJzaGFsbGVkO1xuICAgICAgfSkgYXMgTWVzc2FnZVtdO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnUmV0cmlldmVkIG1lc3NhZ2VzOicsIG1lc3NhZ2VzLmxlbmd0aCk7XG4gICAgICByZXR1cm4gbWVzc2FnZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgbWVzc2FnZXMgZnJvbSBEeW5hbW9EQjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgdG9nZ2xlUmVhY3Rpb24oeyBtZXNzYWdlSWQsIGVtb2ppLCB1c2VySWQsIHVzZXJuYW1lIH06IFJlYWN0aW9uRGF0YSkge1xuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnVG9nZ2xpbmcgcmVhY3Rpb246JywgeyBtZXNzYWdlSWQsIGVtb2ppLCB1c2VySWQgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHNjYW5QYXJhbXMgPSB7XG4gICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgICAgRmlsdGVyRXhwcmVzc2lvbjogJ2lkID0gOm1lc3NhZ2VJZCcsXG4gICAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IG1hcnNoYWxsKHtcbiAgICAgICAgICAnOm1lc3NhZ2VJZCc6IG1lc3NhZ2VJZFxuICAgICAgICB9KVxuICAgICAgfTtcblxuICAgICAgY29uc3QgeyBJdGVtcyA9IFtdIH0gPSBhd2FpdCBkeW5hbW9DbGllbnQuc2VuZChuZXcgU2NhbkNvbW1hbmQoc2NhblBhcmFtcykpO1xuICAgICAgaWYgKCFJdGVtcy5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignTWVzc2FnZSBub3QgZm91bmQnKTtcblxuICAgICAgY29uc3QgbWVzc2FnZSA9IHVubWFyc2hhbGwoSXRlbXNbMF0pO1xuICAgICAgY29uc3QgcmVhY3Rpb25zID0gbWVzc2FnZS5yZWFjdGlvbnMgfHwge307XG4gICAgICBjb25zdCB1c2VycyA9IHJlYWN0aW9uc1tlbW9qaV0gfHwgW107XG4gICAgICBjb25zdCBoYXNSZWFjdGVkID0gdXNlcnMuaW5jbHVkZXModXNlcklkKTtcblxuICAgICAgY29uc3QgdXBkYXRlUGFyYW1zOiBhbnkgPSB7XG4gICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgICAgS2V5OiBtYXJzaGFsbCh7XG4gICAgICAgICAgY2hhbm5lbElkOiBtZXNzYWdlLmNoYW5uZWxJZCxcbiAgICAgICAgICB0aW1lc3RhbXA6IG1lc3NhZ2UudGltZXN0YW1wXG4gICAgICAgIH0pXG4gICAgICB9O1xuXG4gICAgICBpZiAoIW1lc3NhZ2UucmVhY3Rpb25zKSB7XG4gICAgICAgIHVwZGF0ZVBhcmFtcy5VcGRhdGVFeHByZXNzaW9uID0gJ1NFVCByZWFjdGlvbnMgPSA6cmVhY3Rpb25zJztcbiAgICAgICAgdXBkYXRlUGFyYW1zLkV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMgPSBtYXJzaGFsbCh7XG4gICAgICAgICAgJzpyZWFjdGlvbnMnOiB7IFtlbW9qaV06IFt1c2VySWRdIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKGhhc1JlYWN0ZWQpIHtcbiAgICAgICAgaWYgKHVzZXJzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIHVwZGF0ZVBhcmFtcy5VcGRhdGVFeHByZXNzaW9uID0gJ1JFTU9WRSByZWFjdGlvbnMuI2UnO1xuICAgICAgICAgIHVwZGF0ZVBhcmFtcy5FeHByZXNzaW9uQXR0cmlidXRlTmFtZXMgPSB7XG4gICAgICAgICAgICAnI2UnOiBlbW9qaVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXBkYXRlUGFyYW1zLlVwZGF0ZUV4cHJlc3Npb24gPSAnU0VUIHJlYWN0aW9ucy4jZSA9IDp1c2Vycyc7XG4gICAgICAgICAgdXBkYXRlUGFyYW1zLkV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lcyA9IHtcbiAgICAgICAgICAgICcjZSc6IGVtb2ppXG4gICAgICAgICAgfTtcbiAgICAgICAgICB1cGRhdGVQYXJhbXMuRXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlcyA9IG1hcnNoYWxsKHtcbiAgICAgICAgICAgICc6dXNlcnMnOiB1c2Vycy5maWx0ZXIoKGlkOiBzdHJpbmcpID0+IGlkICE9PSB1c2VySWQpXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVwZGF0ZVBhcmFtcy5VcGRhdGVFeHByZXNzaW9uID0gJ1NFVCByZWFjdGlvbnMuI2UgPSA6dXNlcnMnO1xuICAgICAgICB1cGRhdGVQYXJhbXMuRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzID0ge1xuICAgICAgICAgICcjZSc6IGVtb2ppXG4gICAgICAgIH07XG4gICAgICAgIHVwZGF0ZVBhcmFtcy5FeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzID0gbWFyc2hhbGwoe1xuICAgICAgICAgICc6dXNlcnMnOiBbLi4udXNlcnMsIHVzZXJJZF1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IGR5bmFtb0NsaWVudC5zZW5kKG5ldyBVcGRhdGVJdGVtQ29tbWFuZCh1cGRhdGVQYXJhbXMpKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB0b2dnbGluZyByZWFjdGlvbjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgZ2V0TWVzc2FnZShtZXNzYWdlSWQ6IHN0cmluZyk6IFByb21pc2U8TWVzc2FnZSB8IG51bGw+IHtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICBUYWJsZU5hbWU6ICdNZXNzYWdlcycsXG4gICAgICBGaWx0ZXJFeHByZXNzaW9uOiAnaWQgPSA6bWVzc2FnZUlkJyxcbiAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IG1hcnNoYWxsKHtcbiAgICAgICAgJzptZXNzYWdlSWQnOiBtZXNzYWdlSWRcbiAgICAgIH0pXG4gICAgfTtcblxuICAgIGNvbnN0IHsgSXRlbXMgPSBbXSB9ID0gYXdhaXQgZHluYW1vQ2xpZW50LnNlbmQobmV3IFNjYW5Db21tYW5kKHBhcmFtcykpO1xuICAgIGlmICghSXRlbXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICBcbiAgICBjb25zdCBtZXNzYWdlID0gdW5tYXJzaGFsbChJdGVtc1swXSkgYXMgTWVzc2FnZTtcbiAgICByZXR1cm4gbWVzc2FnZTtcbiAgfSxcblxuICBhc3luYyBjbGVhck1lc3NhZ2VzKCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHsgSXRlbXMgPSBbXSB9ID0gYXdhaXQgZHluYW1vQ2xpZW50LnNlbmQobmV3IFNjYW5Db21tYW5kKHBhcmFtcykpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgSXRlbXMpIHtcbiAgICAgICAgY29uc3QgZGVsZXRlUGFyYW1zID0ge1xuICAgICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgICAgICBLZXk6IG1hcnNoYWxsKHtcbiAgICAgICAgICAgIGNoYW5uZWxJZDogdW5tYXJzaGFsbChpdGVtKS5jaGFubmVsSWQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IHVubWFyc2hhbGwoaXRlbSkudGltZXN0YW1wXG4gICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBkeW5hbW9DbGllbnQuc2VuZChuZXcgRGVsZXRlSXRlbUNvbW1hbmQoZGVsZXRlUGFyYW1zKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdDbGVhcmVkIGFsbCBtZXNzYWdlcycpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIG1lc3NhZ2VzOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyByZWFzc2lnbk1lc3NhZ2VzVG9EZWxldGVkVXNlcih1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgYWxsIG1lc3NhZ2VzIGZyb20gdGhpcyB1c2VyXG4gICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgICAgRmlsdGVyRXhwcmVzc2lvbjogJ3VzZXJJZCA9IDp1c2VySWQnLFxuICAgICAgICBFeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzOiBtYXJzaGFsbCh7XG4gICAgICAgICAgJzp1c2VySWQnOiB1c2VySWRcbiAgICAgICAgfSlcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHsgSXRlbXMgPSBbXSB9ID0gYXdhaXQgZHluYW1vQ2xpZW50LnNlbmQobmV3IFNjYW5Db21tYW5kKHBhcmFtcykpO1xuICAgICAgXG4gICAgICAvLyBHZXQgbWVzc2FnZSBJRHMgZm9yIGZpbHRlcmluZyByZXBsaWVzIGxhdGVyXG4gICAgICBjb25zdCBtZXNzYWdlSWRzID0gSXRlbXMubWFwKGl0ZW0gPT4gdW5tYXJzaGFsbChpdGVtKS5pZCk7XG4gICAgICBcbiAgICAgIC8vIFVwZGF0ZSBlYWNoIG1lc3NhZ2UgdG8gdXNlIHRoZSBkZWxldGVkIHVzZXIgSURcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBJdGVtcykge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gdW5tYXJzaGFsbChpdGVtKTtcbiAgICAgICAgY29uc3QgdXBkYXRlUGFyYW1zID0ge1xuICAgICAgICAgIFRhYmxlTmFtZTogJ01lc3NhZ2VzJyxcbiAgICAgICAgICBLZXk6IG1hcnNoYWxsKHtcbiAgICAgICAgICAgIGNoYW5uZWxJZDogbWVzc2FnZS5jaGFubmVsSWQsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG1lc3NhZ2UudGltZXN0YW1wXG4gICAgICAgICAgfSksXG4gICAgICAgICAgVXBkYXRlRXhwcmVzc2lvbjogJ1NFVCB1c2VySWQgPSA6ZGVsZXRlZElkLCB1c2VybmFtZSA9IDpkZWxldGVkTmFtZScsXG4gICAgICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlczogbWFyc2hhbGwoe1xuICAgICAgICAgICAgJzpkZWxldGVkSWQnOiBERUxFVEVEX1VTRVJfSUQsXG4gICAgICAgICAgICAnOmRlbGV0ZWROYW1lJzogJ0RlbGV0ZWQgVXNlcidcbiAgICAgICAgICB9KSxcbiAgICAgICAgICBSZXR1cm5WYWx1ZXM6ICdBTExfTkVXJyBhcyBjb25zdFxuICAgICAgICB9O1xuXG4gICAgICAgIGF3YWl0IGR5bmFtb0NsaWVudC5zZW5kKG5ldyBVcGRhdGVJdGVtQ29tbWFuZCh1cGRhdGVQYXJhbXMpKTtcbiAgICAgIH1cblxuICAgICAgLy8gRmluZCByZXBsaWVzIHVzaW5nIG11bHRpcGxlIHNjYW5zIGlmIG5lZWRlZFxuICAgICAgZm9yIChjb25zdCBtZXNzYWdlSWQgb2YgbWVzc2FnZUlkcykge1xuICAgICAgICBjb25zdCByZXBseVBhcmFtcyA9IHtcbiAgICAgICAgICBUYWJsZU5hbWU6ICdNZXNzYWdlcycsXG4gICAgICAgICAgRmlsdGVyRXhwcmVzc2lvbjogJ3JlcGx5VG9JZCA9IDptZXNzYWdlSWQnLFxuICAgICAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IG1hcnNoYWxsKHtcbiAgICAgICAgICAgICc6bWVzc2FnZUlkJzogbWVzc2FnZUlkXG4gICAgICAgICAgfSlcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCB7IEl0ZW1zOiBSZXBseUl0ZW1zID0gW10gfSA9IGF3YWl0IGR5bmFtb0NsaWVudC5zZW5kKG5ldyBTY2FuQ29tbWFuZChyZXBseVBhcmFtcykpO1xuICAgICAgICBcbiAgICAgICAgLy8gTm8gbmVlZCB0byB1cGRhdGUgcmVwbGllcywganVzdCBrZWVwaW5nIHRoZW0gZm9yIHJlZmVyZW5jZVxuICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtSZXBseUl0ZW1zLmxlbmd0aH0gcmVwbGllcyB0byBtZXNzYWdlICR7bWVzc2FnZUlkfWApO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhc3NpZ25pbmcgbWVzc2FnZXM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufTsgIl0sIm5hbWVzIjpbIkR5bmFtb0RCQ2xpZW50IiwiUHV0SXRlbUNvbW1hbmQiLCJRdWVyeUNvbW1hbmQiLCJVcGRhdGVJdGVtQ29tbWFuZCIsIlNjYW5Db21tYW5kIiwiRGVsZXRlSXRlbUNvbW1hbmQiLCJtYXJzaGFsbCIsInVubWFyc2hhbGwiLCJkeW5hbW9DbGllbnQiLCJyZWdpb24iLCJjcmVkZW50aWFscyIsImFjY2Vzc0tleUlkIiwic2VjcmV0QWNjZXNzS2V5IiwiREVMRVRFRF9VU0VSX0lEIiwibWVzc2FnZVNlcnZpY2UiLCJzZW5kTWVzc2FnZSIsIm1lc3NhZ2UiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwiaWQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJwYXJhbXMiLCJUYWJsZU5hbWUiLCJJdGVtIiwiY2hhbm5lbElkIiwidXNlcklkIiwidGV4dCIsInVzZXJuYW1lIiwicmVwbHlUb0lkIiwicmVhY3Rpb25zIiwic2VuZCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImdldE1lc3NhZ2VzIiwiS2V5Q29uZGl0aW9uRXhwcmVzc2lvbiIsIkV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXMiLCJTY2FuSW5kZXhGb3J3YXJkIiwiSXRlbXMiLCJtZXNzYWdlcyIsIm1hcCIsIml0ZW0iLCJ1bm1hcnNoYWxsZWQiLCJsZW5ndGgiLCJ0b2dnbGVSZWFjdGlvbiIsIm1lc3NhZ2VJZCIsImVtb2ppIiwic2NhblBhcmFtcyIsIkZpbHRlckV4cHJlc3Npb24iLCJFcnJvciIsInVzZXJzIiwiaGFzUmVhY3RlZCIsImluY2x1ZGVzIiwidXBkYXRlUGFyYW1zIiwiS2V5IiwiVXBkYXRlRXhwcmVzc2lvbiIsIkV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lcyIsImZpbHRlciIsImdldE1lc3NhZ2UiLCJjbGVhck1lc3NhZ2VzIiwiZGVsZXRlUGFyYW1zIiwicmVhc3NpZ25NZXNzYWdlc1RvRGVsZXRlZFVzZXIiLCJtZXNzYWdlSWRzIiwiUmV0dXJuVmFsdWVzIiwicmVwbHlQYXJhbXMiLCJSZXBseUl0ZW1zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/messageService.ts\n"));

/***/ })

});